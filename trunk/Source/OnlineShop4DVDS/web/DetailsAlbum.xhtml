<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <ui:composition template="MasterPage.xhtml">
              <ui:define name="deSlide">
                
            </ui:define>
            <ui:define name="contents">
                <h:form>
                    <h:inputHidden value="#{detailAlbumManager.addAlbumID(param['id'])}"></h:inputHidden>
                    <script type="text/javascript" src="Script/jwplayer.js"></script>
                    <div class="DetailsAlbumBackgroundAudio"></div>
                    <div class="DetailsAlbumAudio">
                        <h4 class="titleAudioVideo"></h4>
                        <img id="closePlayer" style="float: right; margin-left: 490px; margin-top: -35px; position: fixed;" src="Images/close.png" alt=""></img>
                        <div id='defaultmediaplayer'></div>
                        <div id="listItem" class="listItemPlayer">
                            <h4 class="DetailsAlbumPlayerH4">List products</h4>
                            <div style="max-height: 150px; overflow-x: hidden; overflow-y: scroll;">
                                <ui:repeat value="#{detailAlbumManager.showDataStore()}" var="dataStore">
                                    <a onclick="playAudioAndVideo('#{dataStore.dataName}','#{dataStore.dataPath}','#{dataStore.dataImage}', true)" class="aItemInList" href="">${dataStore.dataName}</a>
                                </ui:repeat>
                            </div>
                        </div>
                    </div>
                    <script type="text/javascript">
                        $(window).ready(function(){
                            resizeAudioPlayer();
                        });
                        $(window).resize(function(){
                            resizeAudioPlayer();
                        });
                        function resizeAudioPlayer(){
                            $(".DetailsAlbumAudio").css('top', ($(".DetailsAlbumBackgroundAudio").height()-$(".DetailsAlbumAudio").height())/2)
                            $(".DetailsAlbumAudio").css('left', ($(".DetailsAlbumBackgroundAudio").width()-$(".DetailsAlbumAudio").width())/2)
                        }
                        
                        function playAudioAndVideo(sName, sFile, sImage, bdisable){
                            $(".titleAudioVideo").text("Title: " + sName);
                            if(bdisable){
                                $("#listItem").css('display', 'block');
                            }else{
                                $("#listItem").css('display', 'none');
                            }
                            var smp3 = sFile.lastIndexOf('.mp3');
                            var swma = sFile.lastIndexOf('.wma');
                            if (smp3 >= 0)
                            {
                                jwplayer('defaultmediaplayer').setup({
                                    'style': 'DetailsAlbumAudio',
                                    'flashplayer': 'Script/player.swf',
                                    'id': 'playerID',
                                    'autoplay': 'true',
                                    'width': '500',
                                    'height': '60',
                                    'file': sFile,
                                    'repeat': 'always'
                                });
                            }else{
                                if(swma >= 0){
                                    jwplayer('defaultmediaplayer').setup({
                                        'style': 'DetailsAlbumAudio',
                                        'flashplayer': 'Script/player.swf',
                                        'id': 'playerID',
                                        'autoplay': 'true',
                                        'width': '500',
                                        'height': '60',
                                        'file': sFile,
                                        'repeat': 'always'
                                    });
                                }else{
                                    jwplayer('defaultmediaplayer').setup({
                                        'style': 'DetailsAlbumAudio',
                                        'flashplayer': 'Script/player.swf',
                                        'id': 'playerID',
                                        'autoplay': 'true',
                                        'image': sImage,
                                        'width': '500',
                                        'height': '400',
                                        'file': sFile,
                                        'repeat': 'always'
                                    });
                                }
                            }
                            $('.DetailsAlbumBackgroundAudio').css('opacity', '0.5').fadeIn(500);
                            $('.DetailsAlbumAudio').fadeIn(500);
                            resizeAudioPlayer();
                        }
                        $('#closePlayer').click(function(){
                            playAudioAndVideo('', '', 'sImage', false);
                            $("#listItem").css('display', 'none');
                            $('.DetailsAlbumBackgroundAudio').css('opacity', '0.5').fadeOut(500);
                            $('.DetailsAlbumAudio').fadeOut(200);
                        });
                    </script>
                    <c:if test="#{cartManager.displayMessage}">
                        <div class="DetailsAlbumMessage">
                            <c:if test="#{cartManager.typeMessage}">
                                <h5 class="DetailsAlbumMessageOutputLabel" style="color: #ff6766;">#{cartManager.message}</h5>
                            </c:if>
                            <c:if test="#{!cartManager.typeMessage}">
                                <h5 class="DetailsAlbumMessageOutputLabel" style="color: #ff6766;">#{cartManager.message}</h5>
                            </c:if>
                            #{cartManager.messageEmpty()}
                        </div>
                    </c:if>
                    <ui:repeat value="#{detailAlbumManager.showInforAlbum()}" var="album">
                        <div class="DefaultAllbox">
                            <div class="DetailsAlbumImage">
                                <img src="#{album.albumImage}" alt="" title="#{album.albumName}" 
                                     width="170px" height="170px"></img>
                            </div>
                            <div class="DetailsAlbumInfor">
                                <h3 class="DetailsAlbumH2">#{album.albumName}</h3>
                                <p style="color: #818181;">Category Name: <h:outputLabel style="color: #000;" value="#{album.cateName}"></h:outputLabel></p>
                                <p style="color: #818181;">Create Date: <h:outputLabel style="color: #000;" value="#{album.albumDateCreate}"></h:outputLabel></p>
                                <p style="color: #818181;">Supplier: <h:outputLabel style="color: #000;" ></h:outputLabel></p>
                                <p style="color: #818181;">Price:<h:outputLabel style="color: #ff6766; font-weight: 600" value="$ #{album.albumPrice}"></h:outputLabel></p>
                                <p style="color: #818181;">Quantity: <h:outputLabel style="color: #000;" value="#{album.quantity}"></h:outputLabel></p>
                                #{cartManager.valuePageOld("DetailsAlbum.xhtml?id=", param['id'])}
                                <div style="float: left">
                                    <p class=""><a class="abtn" href="addToCartPage.xhtml?DataStoreId=#{album.albumID}">Add to Cart</a>
                                        <a class="abtn" onclick="playAudioAndVideo('#{detailAlbumManager.firstTitle}', 
                                            '#{detailAlbumManager.firstPath}', '#{detailAlbumManager.firstImage}', true)" href="">Play all</a>
                                        <a class="abtn" href="#">Add to my list</a>
                                    </p>
                                </div>
                            </div>
                            <div class="DetailsAlbumDetail">
                                <span style="color: #666; font-style: italic">Description:</span><br/>
                                <h:outputText value="#{album.albumDetails}" escape="false" />
                                <h2 class="DetailsAlbumItmeDataStoreH2">Item in the album</h2>
                                <ui:repeat value="#{detailAlbumManager.showDataStore()}" var="listDataStore">
                                    <div class="DetailsAlbumItemDataStore">
                                        <div class="DetailsAlbumItemDataStoreImg">
                                            <span class="numbercountS">#{detailAlbumManager.countnumbers}</span>
                                            <img alt="" src="#{listDataStore.dataImage}" width="50px" height="50px"></img>
                                            <a class="aplay" onclick="playAudioAndVideo('#{listDataStore.dataName}', '#{listDataStore.dataPath}','#{listDataStore.dataImage}', false)" href="">Listen </a>
                                        </div>
                                        <div class="DetailsAlbumItemDataStoreName">#{listDataStore.dataName}</div>
                                        <div class="DetailsAlbumItemDataStoreIcon">
                                            <a href="#"><img class="DetailsAlbumItemDataStoreIconAddtoList"
                                                             title="Click to add to my playlist " alt="" width="20px"
                                                             src="Images/add-to-playlist.gif"></img></a>
                                        </div>
                                    </div>
                                </ui:repeat>
                            </div>
                        </div>
                    </ui:repeat>
                </h:form>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

